---
output:
  github_document:
    toc: true
    toc_depth: 2
---

<!-- README.md is generated from README.Rmd. Please edit README.Rmd, then run:
     tools/render_readme.R  (recommended)  or  rmarkdown::render("README.Rmd")
-->

<!-- badges: start -->
[![R-CMD-check](https://github.com/ppchaudhary/OmicNetR/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/ppchaudhary/OmicNetR/actions/workflows/R-CMD-check.yaml)
<!--
Uncomment AFTER the package is on CRAN (otherwise it will show as "not found").
[![CRAN status](https://www.r-pkg.org/badges/version/OmicNetR)](https://CRAN.R-project.org/package=OmicNetR)
-->
<!-- badges: end -->

# OmicNetR

**OmicNetR** is an R package for integrative multi-omics analysis using **Sparse Canonical Correlation Analysis (sCCA)**.
It supports an end-to-end workflow for aligning multi-omics datasets, fitting an sCCA model, creating a gene–metabolite
bipartite network, and generating summary visualizations.

## Installation

### Development version (GitHub)

```r
install.packages("devtools")
devtools::install_github("ppchaudhary/OmicNetR")
```

```{r}
library(OmicNetR)
```

## Quick start

```{r}
set.seed(123)

omics_data <- generate_dummy_omics(
  n_samples = 60,
  n_genes = 800,
  n_metabolites = 150,
  n_linked = 20
)

X <- omics_data$X
Y <- omics_data$Y

aligned <- align_omics(X, Y)

scca_model <- omic_scca(
  X = aligned$X,
  Y = aligned$Y,
  n_components = 2,
  penalty_X = 0.70,
  penalty_Y = 0.70
)

net_data <- scca_to_network(
  scca_model,
  comp_select = 1,
  weight_threshold = 0.01
)

# Keep top edges for a cleaner plot
net_data <- net_data[order(abs(net_data$Weight_Product), decreasing = TRUE), ]
net_data <- head(net_data, 50)
```

## Figures

The script `tools/render_readme.R` will (1) generate figures into `man/figures/` and (2) render `README.md`.
If you already generated figures, the blocks below will display them in GitHub.

```{r, include=FALSE}
# Only show images if they exist (pre-generated by tools/render_readme.R)
fig_dir <- file.path("man", "figures")
img_network <- file.path(fig_dir, "network_plot.png")
img_circle  <- file.path(fig_dir, "circle_plot.png")
img_heatmap <- file.path(fig_dir, "heatmap_plot.png")
```

### Bipartite gene–metabolite network

```{r, echo=FALSE, out.width="80%"}
if (file.exists(img_network)) knitr::include_graphics(img_network)
```

### Feature importance circle plot

```{r, echo=FALSE, out.width="70%"}
if (file.exists(img_circle)) knitr::include_graphics(img_circle)
```

### Gene–metabolite correlation heatmap

```{r, echo=FALSE, out.width="80%"}
if (file.exists(img_heatmap)) knitr::include_graphics(img_heatmap)
```

## Included example dataset

```{r}
data(omics_example)
str(omics_example, max.level = 1)
```

> Note: `omics_example` is simulated and intended for demonstration only.

## Main functions

- `generate_dummy_omics()` – generate linked synthetic multi-omics data  
- `align_omics()` – align datasets by sample names  
- `omic_scca()` – perform sparse canonical correlation analysis  
- `scca_to_network()` – convert sCCA loadings to network edges  
- `plot_bipartite_network()` – visualize gene–metabolite networks  
- `plot_pathway_circle()` – feature importance radial plot  
- `plot_correlation_heatmap()` – global correlation heatmap  

## Code of conduct

Please note that the OmicNetR project is released with a Contributor Code of Conduct.
By contributing to this project, you agree to abide by its terms.
